version: '3.8'

services:
  experiment:
    build: .
    container_name: careerhy-experiment
    environment:
      # OpenAI API
      - OPENAI_API_KEY=${OPENAI_API_KEY}

      # AWS S3 ì ‘ê·¼
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION}

      # LangSmith íŠ¸ë ˆì´ì‹±
      - LANGCHAIN_TRACING_V2=${LANGCHAIN_TRACING_V2:-true}
      - LANGCHAIN_ENDPOINT=${LANGCHAIN_ENDPOINT:-https://api.smith.langchain.com}
      - LANGCHAIN_API_KEY=${LANGCHAIN_API_KEY}
      - LANGCHAIN_PROJECT=${LANGCHAIN_PROJECT:-Career-HY-Experiment}

    volumes:
      # ğŸ”¥ ê°œë°œìš©: ì „ì²´ ì½”ë“œ ì‹¤ì‹œê°„ ë§ˆìš´íŠ¸
      - .:/app
      # ì‹¤í—˜ ê²°ê³¼ ì €ì¥ìš© ë³¼ë¥¨
      - ./results:/app/results
      # ì„¤ì • íŒŒì¼ ë§ˆìš´íŠ¸
      - ./configs:/app/configs
      # ë°ì´í„° ë””ë ‰í† ë¦¬ ë§ˆìš´íŠ¸
      - ./data:/app/data
      # ì„ë² ë”© ìºì‹œ ì €ì¥ìš© ë³¼ë¥¨
      - ./cache:/app/cache

    networks:
      - experiment-network

  # ChromaDB ì„œë¹„ìŠ¤ (ì‹¤í—˜ìš© ë²¡í„° DB)
  chromadb:
    image: chromadb/chroma:latest
    container_name: careerhy-chromadb
    ports:
      - "8000:8000"
    volumes:
      - chroma_data:/chroma/chroma
    environment:
      - IS_PERSISTENT=TRUE
    networks:
      - experiment-network

volumes:
  chroma_data:

networks:
  experiment-network:
    driver: bridge